# Генерация и отбор кандидатов для таргетной мишени Acetylcholinesterase

## 1. Выбор мишени

После анализа ряда научных публикаций были выбраны четыре наиболее перспективные мишени:

- **Acetylcholinesterase**
- **Beta-secretase 1**
- **Glycogen synthase kinase-3 beta**
- **Monoamine oxidase B**

Критерии выбора:

1. Перспективность мишени (актуальность и научный интерес)
2. Доступность лигандов для последующего обучения моделей

**Выбранная мишень:** `Acetylcholinesterase`  
Она обладает как научной значимостью, так и достаточным объёмом экспериментальных данных.

---

## 2. Подготовка данных

**Источники данных:**

- [ChEMBL](https://www.ebi.ac.uk/chembl/)
- [IUPHAR/BPS Guide to PHARMACOLOGY](https://www.guidetopharmacology.org/)
- [BindingDB](https://www.bindingdb.org/rwd/bind/index.jsp)


**Количество исходных данных:**
- ~25 000 молекулярных записей

**Количество валидных данных:**
- ~15 000 подходящих молекулярных записей

**Обработка дескрипторов:**

1. Генерация всех возможных дескрипторов с помощью [`RDKit`](https://www.rdkit.org/)
2. Удаление:
   - Пустых значений
   - Признаков с нулевой дисперсией
   - Одного из двух высоко коррелированных признаков (|r| > 0.7)

---

## 3. Обучение моделей

Обученные модели:

- `Random Forest`
- `LightGBM`
- `MLP` (многослойный персептрон)
- `CNN` (сверточная нейронная сеть)

**Результаты:**  
Модель `LightGBM` показала наилучшее качество с **R² > 0.7** на валидационной выборке.

---

## 4. Генерация молекул

Для генерации новых соединений использовались разные подходы, наилучший результат показал **DrugGPT**.

- Сгенерировано: **15 000** молекул
- Валидные SMILES: **2056**

---

## 5. Отбор кандидатов

Молекулы отбирались по следующим критериям(пришлось понизить критерии, иначе список подходящих кондидатов был пуст):

- `pIC₅₀ > 5.5`
- `QED > 0.5`
- `2 < SA Score < 6`
- Отсутствие токсофоров
- Не более одного нарушения **правил Липинского**

**Итог:**  
Выбрано **10** кандидатов.

---

| Показатель                  | Наблюдения                                                                                                                                                                                                                                                                                               |
| --------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Химическая коррект‑сть  | Все 10 SMILES успешно парсятся RDKit; SA‑Score 2.5 – 3.6 (синтез реалистичный, средняя сложность). Большинство — свободные основания, сопровождаемые Br‑/Cl‑ анионами → это соли; перед in vitro придётся пересаливать (HCl, MeSO₃H и т.д.).                                                         |
| Физ‑хим. профиль        | MW ≈ 250 – 445 Da (среднее 355); clogP 3.0 – 4.5; H‑don ≤ 2, H‑acc ≤ 6; ≤ 6 ротаторов → *Lipinski*: все 10 имеют 0 или 1 нарушение (как требовали).                                                                                                                                                  |
| Токсофоры               | Все прошли BRENK‑core и расширенный SMARTS‑лист — т.е. токсофоров не выявлено. Однако у половины — ≥ 2 галогеновых атома (Br/Cl) и/или ≥ 2 нитрила; эти мотивы могут всплыть на следующих стадиях (гепатотокс, генотокс прогнозами).                                                                 |
| QED                     | 0.60 – 0.75 (наш порог был 0.5) — адекватная «drug‑likeness» даже при умеренных размерах и ароматичности.                                                                                                                                                                                                |
| Предсказанная актив‑сть | *Pred\_pIC50* 5.57 – 5.94 ⇒ IC50 ≈ 2.8 – 0.9 µM. Это крепкие «hits», но пока не «lead» (< 1 µM).                                                                                                                                                                                                         |
| Разнообразие            | 10 из 10 имеют уникальный Bemis‑Murcko‑скаффолд → высокая внутривыборочная диверсификация. Гетероядра: индол, бензофуран, бензотиофен, пиримидин, ди‑оксабицикл., оксазол‑/эхо‑фрагменты.                                                                                                            |
| Особые мотивы           | • 4 молекулы содержат ди‑циано или оксим C=N‑O → реактивны/генотокс red‑flags на поздней стадии.<br>• 3 молекулы имеют бромид‑анион — пригодны как соли, но Br‑ может мешать клеточной проницаемости.<br>• 2 молекулы с ди‑хлор‑фенилом: возможна метаб. liability, но это также «тюнингуемый» фрагмент. |

---

## Интерпретация результата

### 1. Химическая «здоровость»

* Ни одной заведомо «выдуманной» функциональности (нет доменов, которые RDKit бы не распознал).
* SA‑Score ≈ 3 указывает на умеренную синтетическую доступность: 3‑4‑стадийные маршруты с коммерческими строительными блоками выглядят реалистично.
* Заметная доля галогенов и нитрилов — нормальна для ранних hit‑фрагментов, но стоит готовиться к «помягчению» этих групп при оптимизации (замена Br → Me/Cl, одно из –CN → H/Cl/CONH₂).

### 2. Разнообразие
* 10 / 10 уникальных Б‑М‑скаффолдов** → библиотека действительно «рассыпана» по химическому пространству; дальнейшее QSAR‑обучение получит больше «обучающих точек» вместо плотного кластера.
* Функциональные группы включают: амид‑пиперидины, индольные/бензодиазепин‑ядра, алифатические нитрилы, оксимы, тиофены, морфолины — есть куда «доклеивать» SAR‑изменения без дублирования.

### 3. Предсказанная активность

* Диапазон pIC50 5.6 – 5.9 — это **1–3 µM. Для первичного in vitro-скрининга хороший старт; но если наш «benchmark» (из литературы) имеет nanomolar ligands, надо продолжать генерацию/фильтрацию или перейти к fine‑tune модели активности.
* Стоит сравнить со всеми известными лигандами вашей цели: если median IC50 у литературы \~10 µM, мы уже впереди; если лучшие 0.1 µM — запас x10–30 на оптимизацию.

### 4. Уникальность

* Ни один SMILES не совпадает с ChEMBL v33 (проверено быстрым подмножественным Tanimoto 0.9 `ECFP4` — 0 совпадений).
* Это означает, что модель генерирует по‑настоящему новые молекулы, а не «пережёвывает» тренировочный набор.

---

## Что делать дальше

| Приоритет       | Следующий шаг                                                                                                                         | Инструмент                                 |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------ |
| Обязательно | Пересольте бромид/хлорид → соответствующие катионы (например, перенесите N‑атом в протонированную форму).                             | `rdkit.Chem.SaltRemover`                   |
| In silico   | Быстрый ADMET (hERG, CYP, DILI, Ames).                                                                                                | SwissADME, pkCSM                           |
| SAR‑химия   | Для каждого скаффолда сделайте «R‑грид» вокруг ключевого N / Br / CN позиции, сохраняя ядро; прогоните через вашу LightGBM‑предиктор. | автоматизированный enumeration + предиктор |
| Docking     | Проверить позы vs. co‑crystal; оценить «clash» брома / фтор‑ароматов.                                                                 | AutoDock Vina / GNINA                      |
| In vitro    | Синтез 2–3 лучших (по SA, predicted potency, ADMET) и подтвердить IC50.                                                               | контрактная химия / local                  |

---

### Вывод

*С текущими мягкими порогами (QED > 0.5, pIC50 > 5.5) модель дала 10 разнообразных, химически реалистичных хитов с микромолярным прогнозом.*
При ужесточении QED ≥ 0.7 и pIC50 ≥ 6, число кандидатов сократится, но качество (drug‑likeness) повысится. В любом случае вы получили уникальный набор стартовых скаффолдов, способный расширить SAR‑пространство вокруг вашей биологической цели.
