# Генерация и отбор кандидатов для таргетной мишени Acetylcholinesterase

## 1. Выбор мишени

После анализа ряда научных публикаций были выбраны четыре наиболее перспективные мишени:

- **Acetylcholinesterase**
- **Beta-secretase 1**
- **Glycogen synthase kinase-3 beta**
- **Monoamine oxidase B**

Критерии выбора:

1. Перспективность мишени (актуальность и научный интерес)
2. Доступность лигандов для последующего обучения моделей

**Выбранная мишень:** `Acetylcholinesterase`  
Она обладает как научной значимостью, так и достаточным объёмом экспериментальных данных.

---

## 2. Подготовка данных

**Источники данных:**

- [ChEMBL](https://www.ebi.ac.uk/chembl/)
- [IUPHAR/BPS Guide to PHARMACOLOGY](https://www.guidetopharmacology.org/)
- [BindingDB](https://www.bindingdb.org/rwd/bind/index.jsp)


**Количество исходных данных:**
- ~25 000 молекулярных записей

**Количество валидных данных:**
- ~15 000 подходящих молекулярных записей

**Обработка дескрипторов:**

1. Генерация всех возможных дескрипторов с помощью [`RDKit`](https://www.rdkit.org/)
2. Удаление:
   - Пустых значений
   - Признаков с нулевой дисперсией
   - Одного из двух высоко коррелированных признаков (|r| > 0.7)

---

## 3. Обучение моделей

Обученные модели:

- `Random Forest`
- `LightGBM`
- `MLP` (многослойный персептрон)
- `CNN` (сверточная нейронная сеть)

**Результаты:**  
Модель `LightGBM` показала наилучшее качество с **R² > 0.7** на валидационной выборке. 

Резултаты моделей:

<img width="500" height="656" alt="image" src="https://github.com/user-attachments/assets/dc78fd83-a7c1-4448-a5ae-b2cf763c7572" />


---

## 4. Генерация молекул

Для генерации новых соединений использовались разные подходы, наилучший результат показал **DrugGPT**.

- Сгенерировано: **15 000** молекул
- Валидные SMILES: **2056**

---

## 5. Отбор кандидатов

Молекулы отбирались по следующим критериям(пришлось понизить критерии, иначе список подходящих кондидатов был пуст):

- `pIC₅₀ > 5.5`
- `QED > 0.5`
- `2 < SA Score < 6`
- Отсутствие токсофоров
- Не более одного нарушения **правил Липинского**

**Итог:**  
Выбрано **10** кандидатов. [CSV с данными о них](step_7/top10.csv)

*Также, в финальном этапе было выполнено пересаливание. Ищем в молекулах одниатомные хлорид-/бромид-соли и меняет к ним галоген на противоположный, без трогания всех остальных молекул.*

---

| Показатель                  | Наблюдения                                                                                                                                                                                                                                                                                               |
| --------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Химическая коррект‑сть  | Все 10 SMILES успешно парсятся RDKit; SA‑Score 2.5 – 3.6 (синтез реалистичный, средняя сложность). Большинство — свободные основания, сопровождаемые Br‑/Cl‑ анионами → это соли.                                                         |
| Физ‑хим. профиль        | MW ≈ 250 – 445 Da (среднее 355); clogP 3.0 – 4.5; H‑don ≤ 2, H‑acc ≤ 6; ≤ 6 ротаторов → *Lipinski*: все 10 имеют 0 или 1 нарушение (как требовали).                                                                                                                                                  |
| Токсофоры               | Все прошли BRENK‑core — т.е. токсофоров не выявлено. Однако у половины — ≥ 2 галогеновых атома (Br/Cl) и/или ≥ 2 нитрила; эти мотивы могут всплыть на следующих стадиях (гепатотокс, генотокс прогнозами).                                                                 |
| QED                     | 0.60 – 0.75 (наш порог был 0.5) — адекватная «drug‑likeness» даже при умеренных размерах и ароматичности.                                                                                                                                                                                                |
| Предсказанная актив‑сть | *Pred\_pIC50* 5.57 – 5.94 ⇒ IC50 ≈ 2.8 – 0.9 µM. Это крепкие «hits», но пока не «lead» (< 1 µM).                                                                                                                                                                                                         |
| Разнообразие            | 10 из 10 имеют уникальный Bemis‑Murcko‑скаффолд → высокая внутривыборочная диверсификация. Гетероядра: индол, бензофуран, бензотиофен, пиримидин, ди‑оксабицикл., оксазол‑/эхо‑фрагменты.                                                                                                            |
| Особые мотивы           | • 4 молекулы содержат ди‑циано или оксим C=N‑O → реактивны/генотокс red‑flags на поздней стадии.<br>• 3 молекулы имеют бромид‑анион — пригодны как соли, но Br‑ может мешать клеточной проницаемости.<br>• 2 молекулы с ди‑хлор‑фенилом: возможна метаб. liability. |

---

## Итоги полученных результатов

* Ни одной заведомо «выдуманной» функциональности (нет доменов, которые RDKit бы не распознал).

* 10 / 10 уникальных Б‑М‑скаффолдов** → библиотека действительно «рассыпана» по химическому пространству; дальнейшее QSAR‑обучение получит больше «обучающих точек» вместо плотного кластера.

* Диапазон pIC50 5.6 – 5.9 — это **1–3 µM. Для первичного in vitro-скрининга хороший старт.

* Ни один SMILES не совпадает с ChEMBL v33 (проверено быстрым подмножественным Tanimoto 0.9 `ECFP4` — 0 совпадений).
* Это означает, что модель генерирует по‑настоящему новые молекулы, а не «пережёвывает» тренировочный набор.

